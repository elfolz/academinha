(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-320d5816"],{"042e":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-main",[i("v-form",{ref:"form"},[i("header",[e.playing?[e._v(" Treino "+e._s(e.training.type)+" "),i("span",[e._v(e._s(e.finishedExercisesCount())+" feitos")])]:[e._v(" "+e._s(e.editting?"Editar":"Novo")+" Treino "),e.editting?i("strong",[e._v(e._s(e.training.type))]):e._e()],e.playing?e._e():i("v-btn",{attrs:{icon:"",title:"Compartilhar treino"},on:{click:e.shareMyTraining}},[i("v-icon",[e._v("share")])],1),e.editting?i("v-btn",{attrs:{icon:"",title:"Deletar treino"},on:{click:function(t){return e.confirmDeleteTraining()}}},[i("v-icon",[e._v("delete")])],1):e._e()],2),e.editting||e.playing?e._e():i("v-select",{attrs:{"hide-details":"",items:e.types,label:"Treino",rules:e.typeRules},model:{value:e.training.type,callback:function(t){e.$set(e.training,"type",t)},expression:"training.type"}}),i("section",{class:{large:e.playing,small:!e.editting&&!e.playing}},[e._l(e.training.exercises,(function(t,s){return i("article",{key:s,class:{finished:e.playing&&t.finished}},[i("div",[i("v-select",{attrs:{"hide-details":"",items:e.categories,"item-text":"name","item-value":"id",label:"Região",rules:e.categoryRules,disabled:e.playing},on:{input:function(t){return e.refreshExercises(s)}},model:{value:t.categoryId,callback:function(i){e.$set(t,"categoryId",i)},expression:"e.categoryId"}}),i("v-select",{attrs:{"hide-details":"",items:e.categoryExercises(t.categoryId),"item-text":"name","item-value":"id",label:"Exercício",rules:e.exerciseRules,disabled:!t.categoryId||e.playing},model:{value:t.exerciseId,callback:function(i){e.$set(t,"exerciseId",i)},expression:"e.exerciseId"}})],1),i("div",[i("v-text-field",{attrs:{"hide-details":"",label:"Séries",type:"tel",rules:e.serieRules,disabled:!t.categoryId||e.playing},model:{value:t.series,callback:function(i){e.$set(t,"series",i)},expression:"e.series"}}),i("v-text-field",{attrs:{"hide-details":"",label:"Repetições",type:"tel",rules:e.repetitionRules,disabled:!t.categoryId||e.playing},model:{value:t.repetitions,callback:function(i){e.$set(t,"repetitions",i)},expression:"e.repetitions"}}),i("v-text-field",{attrs:{"hide-details":"",label:"Peso",type:"tel",disabled:!t.categoryId,suffix:"Kg"},on:{input:function(t){return e.refreshWeight(s,t)}},model:{value:t.weigth,callback:function(i){e.$set(t,"weigth",i)},expression:"e.weigth"}}),i("v-textarea",{attrs:{"hide-details":"","auto-grow":"",rows:1,label:"Observações",disabled:!t.categoryId},on:{input:function(t){return e.refreshDetails(s,t)}},model:{value:t.details,callback:function(i){e.$set(t,"details",i)},expression:"e.details"}})],1),e.playing?e._e():i("v-btn",{attrs:{icon:"",absolute:"",title:"Excluir exercício"},on:{click:function(t){return e.confirmDeleteExercise(s)}}},[i("v-icon",[e._v("delete")])],1),e.playing?i("v-btn",{attrs:{icon:"",absolute:"",title:(t.finished?"Refazer":"Concluir")+" exercício"},on:{click:function(t){return e.toggleFinishExercise(s)}}},[i("v-icon",[e._v(e._s(t.finished?"replay":"check"))])],1):e._e()],1)})),e.playing?e._e():i("mark",{attrs:{id:"page-bottom"}})],2)],1),i("footer",[e.playing?e._e():i("v-btn",{attrs:{block:"",color:"primary"},on:{click:e.addExercise}},[i("v-icon",[e._v("add")]),e._v(" Adicionar Exercício")],1),i("v-btn",{attrs:{text:""},on:{click:e.close}},[i("v-icon",[e._v("clear")]),e._v(" Fechar ")],1),e.playing?e._e():i("v-btn",{attrs:{color:"accent"},on:{click:e.save}},[i("v-icon",[e._v("save")]),e._v(" Salvar ")],1),e.playing?i("rest-timer",{ref:"restTimer"}):e._e()],1),i("dialog-confirmation",{ref:"confirmationDialog",on:{confirm:e.confirmed}})],1)},n=[],r=(i("e9c4"),i("b7ef"),i("5319"),i("c1df")),a=i.n(r),o=i("82a9"),l=i("11aa"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-bottom-sheet",{attrs:{"content-class":"dialog-confirm"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("p",{domProps:{innerHTML:e._s(e.message)}}),i("footer",[i("v-btn",{attrs:{text:""},on:{click:e.cancel}},[i("v-icon",[e._v("clear")]),e._v(" Não ")],1),i("v-btn",{attrs:{text:""},on:{click:e.confirm}},[i("v-icon",[e._v("check")]),e._v(" Sim ")],1)],1)])},h=[],d={name:"dialog-confirmation",data(){return{message:null,show:!1}},methods:{open(e){this.message=e,this.show=!0},confirm(){this.$emit("confirm",!0),this.show=!1},cancel(){this.$emit("cancel",!0),this.show=!1}}},u=d,g=(i("5030"),i("c068"),i("2877")),m=i("6544"),p=i.n(m),v=i("288c"),f=i("8336"),x=i("132d"),y=Object(g["a"])(u,c,h,!1,null,"7898b8b9",null),b=y.exports;p()(y,{VBottomSheet:v["a"],VBtn:f["a"],VIcon:x["a"]});var $=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("main",[e.resting?[i("span",{staticClass:"primary--text"},[e._v(e._s(e.restTime))])]:[i("v-select",{staticClass:"number",attrs:{"hide-details":"",items:e.minutesList,"item-text":"name","item-value":"value"},on:{input:e.refreshRestTime},model:{value:e.minutes,callback:function(t){e.minutes=t},expression:"minutes"}}),e._v("  :  "),i("v-select",{staticClass:"number",attrs:{"hide-details":"",items:e.secondsList,"item-text":"name","item-value":"value"},on:{input:e.refreshRestTime},model:{value:e.seconds,callback:function(t){e.seconds=t},expression:"seconds"}})],i("v-btn",{class:{small:e.smallScreen},attrs:{color:e.resting?"primary":null,title:e.resting?"Parar descanso":"Iniciar descanso"},on:{click:e.toggleRest}},[i("v-icon",[e._v(e._s(e.resting?"pause":"play_arrow"))]),e.smallScreen?e._e():[e._v(e._s(e.resting?"Parar":"Descansar"))]],2)],2)},T=[],_={name:"rest-timer",computed:{audio:{get(){return this.$store.state.audio},set(e){return this.$store.commit("setAudio",e)}}},data(){var e;return{smallScreen:window.innerWidth<=400,restTime:null,resting:!1,restInterval:void 0,restCounter:parseInt(null!==(e=localStorage.getItem("rest"))&&void 0!==e?e:45e3),minutes:null,seconds:null,minutesList:[{name:"00",value:0},{name:"01",value:1},{name:"02",value:2},{name:"03",value:3},{name:"04",value:4},{name:"05",value:5},{name:"06",value:6},{name:"07",value:7},{name:"08",value:8},{name:"09",value:9},{name:"10",value:10}],secondsList:[{name:"00",value:0},{name:"05",value:5},{name:"10",value:10},{name:"15",value:15},{name:"20",value:20},{name:"25",value:25},{name:"30",value:30},{name:"35",value:35},{name:"40",value:40},{name:"45",value:45},{name:"50",value:50},{name:"55",value:55}]}},mounted(){let e=a()(this.restCounter);this.restTime=e.format("mm:ss"),this.minutes=e.minutes(),this.seconds=e.seconds(),this.$root.$on("resize",()=>{this.smallScreen=window.innerWidth<=400})},beforeDestroy(){this.$root.$off("resize")},methods:{refreshRestTime(){let e=a()(0).minute(this.minutes).second(this.seconds);this.restCounter=a.a.duration(e).asMilliseconds(),localStorage.setItem("rest",this.restCounter)},toggleRest(){if(this.resting)this.stopRestTimer(),this.resting=!1;else{this.resting=!0;let e=performance.mark("init"),t=performance.now()-e.startTime;this.restTime=a()(this.restCounter).format("mm:ss"),this.restInterval=setInterval(()=>{if(t=performance.now()-e.startTime,this.restTime=a()(this.restCounter+1e3-t).format("mm:ss"),a.a.duration(t).asMilliseconds()>=this.restCounter){try{navigator.vibrate(500)}catch(i){}this.audio="play",this.stopRestTimer()}},1e3)}},stopRestTimer(){this.resting=!1,this.restTime=a()(this.restCounter).format("mm:ss"),this.restInterval&&(clearInterval(this.restInterval),this.restInterval=void 0)}}},I=_,E=(i("1887"),i("3e42"),i("b974")),S=Object(g["a"])(I,$,T,!1,null,"a83b451a",null),k=S.exports;p()(S,{VBtn:f["a"],VIcon:x["a"],VSelect:E["a"]});var w={components:{dialogConfirmation:b,restTimer:k},computed:{authenticated(){return this.$store.state.authenticated},categories(){return o["a"].sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0).map(e=>(e.exercises=e.exercises.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0),e))},trainings:{get(){return this.$store.state.trainings},set(e){this.$store.commit("setTrainings",e)}}},data(){return{editting:!1,playing:!1,training:{id:null,type:null,exercises:null},pendingAction:null,pendingDeleteExercise:null,finishedExercises:null,types:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),typeRules:[e=>!!e||"Escolha o treino"],categoryRules:[e=>!!e||"Escolha uma Região"],exerciseRules:[e=>!!e||"Escolha um Exercício"],serieRules:[e=>!!e||"Escolha uma Série"],repetitionRules:[e=>!!e||"Escolha uma Repetição"]}},mounted(){"play"==this.$route.params.mode?this.play():"edit"==this.$route.params.mode?this.edit():this.$route.query.shared_training?this.setup():this.open()},beforeDestroy(){var e;null===(e=this.$refs.restTimer)||void 0===e||e.stopRestTimer()},methods:{open(e){var t,i,s;this.editting=!1,this.playing=!1,this.types=this.types,null===(t=this.$refs.form)||void 0===t||t.reset(),this.training={type:null!==(i=null===e||void 0===e?void 0:e.type)&&void 0!==i?i:null,exercises:null!==(s=null===e||void 0===e?void 0:e.exercises)&&void 0!==s?s:[]};let n=JSON.parse(JSON.stringify(this.trainings)).map(e=>e.type);n.length&&(this.types=this.types.filter(e=>!n.includes(e)))},edit(){let e=this.$route.params.id;if(!e||!this.trainings.length)return this.$router.push("/").catch(e=>{});this.editting=!0,this.playing=!1,this.training=JSON.parse(JSON.stringify(this.trainings)).find(t=>1==e.toString().length?t.type==e:t.id==e)},setup(){try{this.open(JSON.parse(atob(this.$route.query.shared_training)))}catch(e){this.$store.dispatch("openAlert",{text:"Falha ao criar seu treino! Tente novamente.",color:"error"})}},play(){let e=this.$route.params.id;if(!e||!this.trainings.length)return this.$router.push("/").catch(e=>{});this.editting=!1,this.playing=!0,this.training=JSON.parse(JSON.stringify(this.trainings)).find(t=>1==e.toString().length?t.type==e:t.id==e),this.refreshFinishedExercises()},addExercise(){this.training.exercises.push({categoryId:null,exerciseId:null,series:3,repetitions:12,weigth:null,details:null}),setTimeout(()=>{document.querySelector("#page-bottom").scrollIntoView({behavior:"smooth",block:"end"})},100)},categoryExercises(e){var t,i,s;return null!==(t=null===(i=this.categories)||void 0===i||null===(s=i.find(t=>t.id==e))||void 0===s?void 0:s.exercises)&&void 0!==t?t:[]},confirmDeleteTraining(){this.pendingAction="deleteTraining",this.$refs.confirmationDialog.open(`Deletar o treino <strong>${this.type}</strong>?`)},confirmDeleteExercise(e){var t,i;this.pendingAction="deleteExercise",this.pendingDeleteExercise=e;let s=this.training.exercises[e].categoryId,n=this.categories.find(e=>e.id==s),r=this.training.exercises[e].exerciseId,a=n?n.exercises.find(e=>e.id==r):null,o=`${null!==(t=null===n||void 0===n?void 0:n.name)&&void 0!==t?t:""}${a?" - "+(null!==(i=null===a||void 0===a?void 0:a.name)&&void 0!==i?i:""):""}`;this.$refs.confirmationDialog.open(`Deletar o exercício <strong>${o}</strong>?`)},confirmed(){"replaceTraining"==this.pendingAction&&this.replace(),"deleteTraining"==this.pendingAction&&this.deleteTraining(),"deleteExercise"==this.pendingAction&&this.training.exercises.splice(this.pendingDeleteExercise,1),this.pendingAction=null},save(){let e=void 0;if(this.$refs.form.validate()||(e="Há campos incorretos!"),this.training.exercises.length||(e="Adicione exercícios!"),e)return this.$store.dispatch("openAlert",{text:e,color:"warning"});!this.authenticated||this.training.id?this.put():this.post()},post(){if(this.trainings.find(e=>e.type==this.training.type))return this.pendingAction="replaceTraining",this.$refs.confirmationDialog.open(`Você já tem um treino <strong>${this.training.type}</strong>, quer substituí-lo?`);this.$sync.sendTrainings([this.training]).then(()=>{this.$store.dispatch("openAlert",{text:"Treino salvo com sucesso!",color:"success"}),this.close()}).catch(e=>{this.$store.dispatch("openAlert",{text:"Erro ao salvar! Tente novamente.",color:"error"}),console.log(e)})},replace(){let e=JSON.parse(JSON.stringify(this.trainings)).find(e=>e.type==this.training.type);e.id?(this.training.id=e.id,this.put()):this.post()},put(){this.$sync.updateTraining(this.training).then(()=>{this.$store.dispatch("openAlert",{text:"Treino salvo com sucesso!",color:"success"}),this.close()}).catch(e=>{this.$store.dispatch("openAlert",{text:"Erro ao salvar! Tente novamente.",color:"error"}),console.log(e)})},deleteTraining(){this.$sync.deleteTraining(this.training).then(()=>{this.$store.dispatch("openAlert",{text:"Treino deletado com sucesso!",color:"success"}),this.close()}).catch(e=>{this.$store.dispatch("openAlert",{text:"Erro ao deletar! Tente novamente.",color:"error"}),console.log(e)})},shareMyTraining(){let e=void 0;if(this.$refs.form.validate()||(e="Há campos incorretos!"),this.training.exercises.length||(e="Adicione exercícios!"),e)return this.$store.dispatch("openAlert",{text:e,color:"warning"});Object(l["a"])(this.training)},toggleFinishExercise(e){this.training.exercises[e].finished=!this.training.exercises[e].finished;let t=this.training.exercises.filter(e=>e.finished).map(e=>({categoryId:e.categoryId,exerciseId:e.exerciseId}));if(t.length){let e={type:this.training.type,exercises:t,expires:a()().add(2,"hour").format()};localStorage.setItem("finishedExercises",JSON.stringify(e))}else localStorage.removeItem("finishedExercises");this.$forceUpdate()},close(){var e;null===(e=this.$refs.restTimer)||void 0===e||e.stopRestTimer(),this.$router.push("/").catch(e=>{})},refreshExercises(e){this.training.exercises[e]&&(this.training.exercises[e].exerciseId=null)},refreshWeight(e,t){this.playing&&this.training.type&&(this.training.exercises[e].weigth=t,this.refreshLocalTraining())},refreshDetails(e,t){this.playing&&this.training.type&&(this.training.exercises[e].details=t,this.refreshLocalTraining())},refreshLocalTraining(){this.authenticated&&this.training.id?this.axios.put("/trainings/"+this.training.id,this.training,{headers:this.$auth.headers}).then(()=>this.$db.trainings.put(this.training)):this.$db.trainings.put(this.training)},finishedExercisesCount(){let e=this.training.exercises.filter(e=>e.finished).length,t=this.training.exercises.length;return`${e} / ${t}`},refreshFinishedExercises(){let e=JSON.parse(localStorage.getItem("finishedExercises")||null);if((null===e||void 0===e?void 0:e.type)==this.training.type&&null!==e&&void 0!==e&&e.exercises.length){if(a()().isAfter(e.expires))return localStorage.removeItem("finishedExercises");this.finishedExercises=e.exercises}else this.finishedExercises=[];this.training.exercises=this.training.exercises.map(e=>(e.finished=!!this.finishedExercises.find(t=>t.categoryId==e.categoryId&&t.exerciseId==e.exerciseId),e))}}},R=w,A=(i("257b"),i("4bd4")),D=i("f6c4"),C=i("8654"),O=i("a844"),V=Object(g["a"])(R,s,n,!1,null,"15c83356",null);t["default"]=V.exports;p()(V,{VBtn:f["a"],VForm:A["a"],VIcon:x["a"],VMain:D["a"],VSelect:E["a"],VTextField:C["a"],VTextarea:O["a"]})},1887:function(e,t,i){"use strict";i("b921")},2424:function(e,t,i){},"257b":function(e,t,i){"use strict";i("2424")},"3e42":function(e,t,i){"use strict";i("c076")},5030:function(e,t,i){"use strict";i("5f45")},"5f45":function(e,t,i){},af0a:function(e,t,i){},b921:function(e,t,i){},c068:function(e,t,i){"use strict";i("af0a")},c076:function(e,t,i){}}]);